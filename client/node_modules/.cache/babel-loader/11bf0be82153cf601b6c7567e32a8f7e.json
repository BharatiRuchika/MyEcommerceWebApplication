{"ast":null,"code":"import _toConsumableArray from\"/Users/ruchikaashokbharati/Documents/Projects/Ecommerce/Ecommerce-Backend-main/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/ruchikaashokbharati/Documents/Projects/Ecommerce/Ecommerce-Backend-main/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import Loader from\"../layouts/loader\";import MetaData from'../layouts/MetaData';import{useAlert}from'react-alert';import{useDispatch,useSelector}from'react-redux';import{updateProduct,clearErrors,getProductDetails}from'../../actions/productActions';import{Link}from'react-router-dom';import Sidebar from'./Sidebar';import{UPDATE_PRODUCT_RESET}from'../../constants/productConstants';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var UpdateProduct=function UpdateProduct(_ref){var match=_ref.match,history=_ref.history;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),price=_useState4[0],setPrice=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),description=_useState6[0],setDescription=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),category=_useState8[0],setCategory=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),stock=_useState10[0],setStock=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),seller=_useState12[0],setSeller=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),images=_useState14[0],setImages=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),oldImages=_useState16[0],setOldImages=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),imagesPreview=_useState18[0],setImagesPreview=_useState18[1];var alert=useAlert();var dispatch=useDispatch();var _useSelector=useSelector(function(state){return state.productDetails;}),error=_useSelector.error,product=_useSelector.product;var _useSelector2=useSelector(function(state){return state.deleteProduct;}),loading=_useSelector2.loading,updateError=_useSelector2.error,isUpdated=_useSelector2.isUpdated;var productId=match.params.id;// const productId = match.params.id;\nvar categories=[\"Electronics\",\"Cameras\",\"Laptops\",\"Accessories\",\"Headphones\",\"Food\",\"Books\",\"Clothes/Shoes\",\"Beauty/Health\",\"Sports\",\"outdoor\",\"Home\"];useEffect(function(){if(product&&product._id!==productId){// console.log(product._id,productId);\n// console.log(\"im here\");\ndispatch(getProductDetails(productId));}else{setName(product.name);setPrice(product.price);setDescription(product.description);setCategory(product.category);setSeller(product.seller);setStock(product.stock);setOldImages(product.images);}if(error){alert.error(error);dispatch(clearErrors());}if(updateError){alert.error(updateError);dispatch(clearErrors());}if(isUpdated){history.push(\"/admin/products\");alert.success(\"Product Updated Successfully\");dispatch({type:UPDATE_PRODUCT_RESET});}// console.log(\"im in list orders\");\n},[error,alert,isUpdated,history,dispatch,product,productId]);var submitHandler=function submitHandler(e){// console.log(\"im in submit handler\");\n// console.log(\"seller\",seller);\ne.preventDefault();var formData=new FormData();formData.set(\"name\",name);formData.set(\"price\",price);formData.set(\"description\",description);formData.set(\"category\",category);formData.set(\"stock\",stock);formData.set(\"seller\",seller);images.forEach(function(image){formData.append('images',image);});// console.log(\"formData\",formData);\n// console.log(\"id\",product._id)\ndispatch(updateProduct(product._id,formData));};var onChange=function onChange(e){var files=Array.from(e.target.files);setImagesPreview([]);setImages([]);setOldImages([]);files.forEach(function(file){var reader=new FileReader();reader.onload=function(){if(reader.readyState===2){// console.log(\"reader\",reader.result);\nsetImagesPreview(function(oldArray){return[].concat(_toConsumableArray(oldArray),[reader.result]);});setImages(function(oldArray){return[].concat(_toConsumableArray(oldArray),[reader.result]);});}};reader.readAsDataURL(file);});};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(MetaData,{title:\"Update Product\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-12 col-md-2\",children:/*#__PURE__*/_jsx(Sidebar,{})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-12 col-md-10\",children:/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"wrapper my-5\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:submitHandler,className:\"shadow-lg\",encType:\"multipart/form-data\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"mb-4\",children:\"Update Product\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"name_field\",children:\"Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"name_field\",className:\"form-control\",value:name,onChange:function onChange(e){return setName(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"price_field\",children:\"Price\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"price_field\",className:\"form-control\",value:price,onChange:function onChange(e){return setPrice(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"description_field\",children:\"Description\"}),/*#__PURE__*/_jsx(\"textarea\",{className:\"form-control\",id:\"description_field\",rows:\"8\",value:description,onChange:function onChange(e){return setDescription(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"category_field\",children:\"Category\"}),/*#__PURE__*/_jsx(\"select\",{className:\"form-control\",id:\"category_field\",value:category,onChange:function onChange(e){return setCategory(e.target.value);},children:categories.map(function(category){return/*#__PURE__*/_jsx(\"option\",{value:category,children:category},category);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"stock_field\",children:\"Stock\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",id:\"stock_field\",className:\"form-control\",value:stock,onChange:function onChange(e){return setStock(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"seller_field\",children:\"Seller Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"seller_field\",className:\"form-control\",value:seller,onChange:function onChange(e){return setSeller(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Images\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"custom-file\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"product_images\",className:\"custom-file-input\",id:\"customFile\",onChange:onChange,multiple:true}),/*#__PURE__*/_jsx(\"label\",{className:\"custom-file-label\",htmlFor:\"customFile\",children:\"Choose Images\"})]}),oldImages&&oldImages.map(function(img){return/*#__PURE__*/_jsx(\"img\",{src:img.url,alt:img.url,className:\"mt-3 mr-2\",width:\"55\",height:\"52\"},img);}),imagesPreview.map(function(img){return/*#__PURE__*/_jsx(\"img\",{src:img,alt:\"Images Preview\",className:\"mt-3 mr-2\",width:\"55\",height:\"52\"},img);})]}),/*#__PURE__*/_jsx(\"button\",{id:\"login_button\",type:\"submit\",className:\"btn btn-block py-3\",disabled:loading?true:false,children:\"UPDATE\"})]})})})})]})]});};export default UpdateProduct;","map":{"version":3,"sources":["/Users/ruchikaashokbharati/Documents/Projects/Ecommerce/Ecommerce-Backend-main/client/src/components/admin/UpdateProduct.js"],"names":["React","useState","useEffect","Loader","MetaData","useAlert","useDispatch","useSelector","updateProduct","clearErrors","getProductDetails","Link","Sidebar","UPDATE_PRODUCT_RESET","UpdateProduct","match","history","name","setName","price","setPrice","description","setDescription","category","setCategory","stock","setStock","seller","setSeller","images","setImages","oldImages","setOldImages","imagesPreview","setImagesPreview","alert","dispatch","state","productDetails","error","product","deleteProduct","loading","updateError","isUpdated","productId","params","id","categories","_id","push","success","type","submitHandler","e","preventDefault","formData","FormData","set","forEach","image","append","onChange","files","Array","from","target","file","reader","FileReader","onload","readyState","oldArray","result","readAsDataURL","value","map","img","url"],"mappings":"8VAAA,MAAOA,CAAAA,KAAP,EAAcC,QAAd,CAAuBC,SAAvB,KAAuC,OAAvC,CACA,MAAOC,CAAAA,MAAP,KAAmB,mBAAnB,CACA,MAAOC,CAAAA,QAAP,KAAqB,qBAArB,CACA,OAASC,QAAT,KAAyB,aAAzB,CACA,OAASC,WAAT,CAAqBC,WAArB,KAAwC,aAAxC,CACA,OAASC,aAAT,CAAuBC,WAAvB,CAAmCC,iBAAnC,KAA4D,8BAA5D,CACA,OAASC,IAAT,KAAqB,kBAArB,CACA,MAAOC,CAAAA,OAAP,KAAoB,WAApB,CACA,OAASC,oBAAT,KAAqC,kCAArC,C,6IACA,GAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,MAAqB,IAAnBC,CAAAA,KAAmB,MAAnBA,KAAmB,CAAbC,OAAa,MAAbA,OAAa,CACvC,cAAuBf,QAAQ,CAAC,EAAD,CAA/B,wCAAOgB,IAAP,eAAYC,OAAZ,eACA,eAAyBjB,QAAQ,CAAC,CAAD,CAAjC,yCAAOkB,KAAP,eAAaC,QAAb,eACA,eAAqCnB,QAAQ,CAAC,EAAD,CAA7C,yCAAOoB,WAAP,eAAmBC,cAAnB,eACA,eAA+BrB,QAAQ,CAAC,EAAD,CAAvC,yCAAOsB,QAAP,eAAgBC,WAAhB,eACA,eAAyBvB,QAAQ,CAAC,CAAD,CAAjC,0CAAOwB,KAAP,gBAAaC,QAAb,gBACA,gBAA2BzB,QAAQ,CAAC,EAAD,CAAnC,2CAAO0B,MAAP,gBAAcC,SAAd,gBACA,gBAA2B3B,QAAQ,CAAC,EAAD,CAAnC,2CAAO4B,MAAP,gBAAcC,SAAd,gBACA,gBAAiC7B,QAAQ,CAAC,EAAD,CAAzC,2CAAO8B,SAAP,gBAAiBC,YAAjB,gBACA,gBAAyC/B,QAAQ,CAAC,EAAD,CAAjD,2CAAOgC,aAAP,gBAAqBC,gBAArB,gBACA,GAAMC,CAAAA,KAAK,CAAG9B,QAAQ,EAAtB,CACA,GAAM+B,CAAAA,QAAQ,CAAG9B,WAAW,EAA5B,CACA,iBAAwBC,WAAW,CAAC,SAAA8B,KAAK,QAAEA,CAAAA,KAAK,CAACC,cAAR,EAAN,CAAnC,CAAOC,KAAP,cAAOA,KAAP,CAAaC,OAAb,cAAaA,OAAb,CAEA,kBAA8CjC,WAAW,CAAC,SAAA8B,KAAK,QAAEA,CAAAA,KAAK,CAACI,aAAR,EAAN,CAAzD,CAAOC,OAAP,eAAOA,OAAP,CAAqBC,WAArB,eAAeJ,KAAf,CAAiCK,SAAjC,eAAiCA,SAAjC,CACA,GAAMC,CAAAA,SAAS,CAAG9B,KAAK,CAAC+B,MAAN,CAAaC,EAA/B,CACA;AAGA,GAAMC,CAAAA,UAAU,CAAG,CACf,aADe,CAEf,SAFe,CAGf,SAHe,CAIf,aAJe,CAKf,YALe,CAMf,MANe,CAOf,OAPe,CAQf,eARe,CASf,eATe,CAUf,QAVe,CAWf,SAXe,CAYf,MAZe,CAAnB,CAcA9C,SAAS,CAAC,UAAM,CACZ,GAAGsC,OAAO,EAAIA,OAAO,CAACS,GAAR,GAAcJ,SAA5B,CAAsC,CAClC;AACA;AAEAT,QAAQ,CAAC1B,iBAAiB,CAACmC,SAAD,CAAlB,CAAR,CACH,CALD,IAKK,CACD3B,OAAO,CAACsB,OAAO,CAACvB,IAAT,CAAP,CACAG,QAAQ,CAACoB,OAAO,CAACrB,KAAT,CAAR,CACAG,cAAc,CAACkB,OAAO,CAACnB,WAAT,CAAd,CACAG,WAAW,CAACgB,OAAO,CAACjB,QAAT,CAAX,CACAK,SAAS,CAACY,OAAO,CAACb,MAAT,CAAT,CACAD,QAAQ,CAACc,OAAO,CAACf,KAAT,CAAR,CACAO,YAAY,CAACQ,OAAO,CAACX,MAAT,CAAZ,CACH,CACD,GAAGU,KAAH,CAAS,CACRJ,KAAK,CAACI,KAAN,CAAYA,KAAZ,EACAH,QAAQ,CAAC3B,WAAW,EAAZ,CAAR,CACH,CACD,GAAGkC,WAAH,CAAe,CACZR,KAAK,CAACI,KAAN,CAAYI,WAAZ,EACAP,QAAQ,CAAC3B,WAAW,EAAZ,CAAR,CACF,CACD,GAAGmC,SAAH,CAAa,CACX5B,OAAO,CAACkC,IAAR,CAAa,iBAAb,EACAf,KAAK,CAACgB,OAAN,CAAc,8BAAd,EACAf,QAAQ,CAAC,CAACgB,IAAI,CAACvC,oBAAN,CAAD,CAAR,CACD,CAEE;AACF,CA9BO,CA8BL,CAAC0B,KAAD,CAAOJ,KAAP,CAAaS,SAAb,CAAuB5B,OAAvB,CAA+BoB,QAA/B,CAAwCI,OAAxC,CAAgDK,SAAhD,CA9BK,CAAT,CA+BC,GAAMQ,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACC,CAAD,CAAK,CACxB;AACA;AACAA,CAAC,CAACC,cAAF,GACC,GAAMC,CAAAA,QAAQ,CAAG,GAAIC,CAAAA,QAAJ,EAAjB,CACDD,QAAQ,CAACE,GAAT,CAAa,MAAb,CAAoBzC,IAApB,EACAuC,QAAQ,CAACE,GAAT,CAAa,OAAb,CAAqBvC,KAArB,EACAqC,QAAQ,CAACE,GAAT,CAAa,aAAb,CAA2BrC,WAA3B,EACAmC,QAAQ,CAACE,GAAT,CAAa,UAAb,CAAwBnC,QAAxB,EACAiC,QAAQ,CAACE,GAAT,CAAa,OAAb,CAAqBjC,KAArB,EACA+B,QAAQ,CAACE,GAAT,CAAa,QAAb,CAAsB/B,MAAtB,EACAE,MAAM,CAAC8B,OAAP,CAAe,SAAAC,KAAK,CAAI,CACpBJ,QAAQ,CAACK,MAAT,CAAgB,QAAhB,CAA0BD,KAA1B,EACH,CAFD,EAGA;AACA;AACAxB,QAAQ,CAAC5B,aAAa,CAACgC,OAAO,CAACS,GAAT,CAAaO,QAAb,CAAd,CAAR,CACA,CAjBH,CAkBE,GAAMM,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAAAR,CAAC,CAAG,CACpB,GAAMS,CAAAA,KAAK,CAAGC,KAAK,CAACC,IAAN,CAAWX,CAAC,CAACY,MAAF,CAASH,KAApB,CAAd,CACA7B,gBAAgB,CAAC,EAAD,CAAhB,CACAJ,SAAS,CAAC,EAAD,CAAT,CACAE,YAAY,CAAC,EAAD,CAAZ,CACA+B,KAAK,CAACJ,OAAN,CAAc,SAAAQ,IAAI,CAAE,CAChB,GAAMC,CAAAA,MAAM,CAAG,GAAIC,CAAAA,UAAJ,EAAf,CACAD,MAAM,CAACE,MAAP,CAAgB,UAAI,CAChB,GAAGF,MAAM,CAACG,UAAP,GAAsB,CAAzB,CAA2B,CACvB;AACArC,gBAAgB,CAAC,SAAAsC,QAAQ,qCAAMA,QAAN,GAAeJ,MAAM,CAACK,MAAtB,IAAT,CAAhB,CACA3C,SAAS,CAAC,SAAA0C,QAAQ,qCAAMA,QAAN,GAAeJ,MAAM,CAACK,MAAtB,IAAT,CAAT,CACH,CACJ,CAND,CAOAL,MAAM,CAACM,aAAP,CAAqBP,IAArB,EACH,CAVD,EAWH,CAhBE,CAiBH,mBACG,wCACC,KAAC,QAAD,EAAU,KAAK,CAAE,gBAAjB,EADD,cAEA,aAAK,SAAS,CAAC,KAAf,wBACE,YAAK,SAAS,CAAC,iBAAf,uBACI,KAAC,OAAD,IADJ,EADF,cAIE,YAAK,SAAS,CAAC,kBAAf,uBACM,sCACA,YAAK,SAAS,CAAC,cAAf,uBACP,cAAM,QAAQ,CAAEd,aAAhB,CAA+B,SAAS,CAAC,WAAzC,CAAqD,OAAO,CAAC,qBAA7D,wBACI,WAAI,SAAS,CAAC,MAAd,4BADJ,cAGI,aAAK,SAAS,CAAC,YAAf,wBACE,cAAO,OAAO,CAAC,YAAf,kBADF,cAEE,cACE,IAAI,CAAC,MADP,CAEE,EAAE,CAAC,YAFL,CAGE,SAAS,CAAC,cAHZ,CAIE,KAAK,CAAEpC,IAJT,CAKE,QAAQ,CAAE,kBAACqC,CAAD,QAAKpC,CAAAA,OAAO,CAACoC,CAAC,CAACY,MAAF,CAASS,KAAV,CAAZ,EALZ,EAFF,GAHJ,cAcI,aAAK,SAAS,CAAC,YAAf,wBACI,cAAO,OAAO,CAAC,aAAf,mBADJ,cAEI,cACE,IAAI,CAAC,MADP,CAEE,EAAE,CAAC,aAFL,CAGE,SAAS,CAAC,cAHZ,CAIE,KAAK,CAAExD,KAJT,CAKE,QAAQ,CAAE,kBAACmC,CAAD,QAAKlC,CAAAA,QAAQ,CAACkC,CAAC,CAACY,MAAF,CAASS,KAAV,CAAb,EALZ,EAFJ,GAdJ,cAyBM,aAAK,SAAS,CAAC,YAAf,wBACE,cAAO,OAAO,CAAC,mBAAf,yBADF,cAEE,iBAAU,SAAS,CAAC,cAApB,CAAmC,EAAE,CAAC,mBAAtC,CAA0D,IAAI,CAAC,GAA/D,CAAmE,KAAK,CAAEtD,WAA1E,CAAuF,QAAQ,CAAE,kBAACiC,CAAD,QAAKhC,CAAAA,cAAc,CAACgC,CAAC,CAACY,MAAF,CAASS,KAAV,CAAnB,EAAjG,EAFF,GAzBN,cA8BM,aAAK,SAAS,CAAC,YAAf,wBACE,cAAO,OAAO,CAAC,gBAAf,sBADF,cAEE,eAAQ,SAAS,CAAC,cAAlB,CAAiC,EAAE,CAAC,gBAApC,CAAqD,KAAK,CAAEpD,QAA5D,CAAsE,QAAQ,CAAE,kBAAC+B,CAAD,QAAK9B,CAAAA,WAAW,CAAC8B,CAAC,CAACY,MAAF,CAASS,KAAV,CAAhB,EAAhF,UACC3B,UAAU,CAAC4B,GAAX,CAAe,SAAArD,QAAQ,qBACpB,eAAuB,KAAK,CAAEA,QAA9B,UAAyCA,QAAzC,EAAaA,QAAb,CADoB,EAAvB,CADD,EAFF,GA9BN,cAsCM,aAAK,SAAS,CAAC,YAAf,wBACE,cAAO,OAAO,CAAC,aAAf,mBADF,cAEE,cACE,IAAI,CAAC,QADP,CAEE,EAAE,CAAC,aAFL,CAGE,SAAS,CAAC,cAHZ,CAIE,KAAK,CAAEE,KAJT,CAKE,QAAQ,CAAE,kBAAC6B,CAAD,QAAK5B,CAAAA,QAAQ,CAAC4B,CAAC,CAACY,MAAF,CAASS,KAAV,CAAb,EALZ,EAFF,GAtCN,cAiDM,aAAK,SAAS,CAAC,YAAf,wBACE,cAAO,OAAO,CAAC,cAAf,yBADF,cAEE,cACE,IAAI,CAAC,MADP,CAEE,EAAE,CAAC,cAFL,CAGE,SAAS,CAAC,cAHZ,CAIE,KAAK,CAAEhD,MAJT,CAKE,QAAQ,CAAE,kBAAC2B,CAAD,QAAK1B,CAAAA,SAAS,CAAC0B,CAAC,CAACY,MAAF,CAASS,KAAV,CAAd,EALZ,EAFF,GAjDN,cA4DM,aAAK,SAAS,CAAC,YAAf,wBACE,iCADF,cAGM,aAAK,SAAS,CAAC,aAAf,wBACI,cACI,IAAI,CAAC,MADT,CAEI,IAAI,CAAC,gBAFT,CAGI,SAAS,CAAC,mBAHd,CAII,EAAE,CAAC,YAJP,CAKI,QAAQ,CAAEb,QALd,CAMI,QAAQ,KANZ,EADJ,cASI,cAAO,SAAS,CAAC,mBAAjB,CAAqC,OAAO,CAAC,YAA7C,2BATJ,GAHN,CAiBO/B,SAAS,EAAIA,SAAS,CAAC6C,GAAV,CAAc,SAAAC,GAAG,qBAC3B,YAAe,GAAG,CAAEA,GAAG,CAACC,GAAxB,CAA6B,GAAG,CAAED,GAAG,CAACC,GAAtC,CAA2C,SAAS,CAAC,WAArD,CAAiE,KAAK,CAAC,IAAvE,CAA4E,MAAM,CAAC,IAAnF,EAAUD,GAAV,CAD2B,EAAjB,CAjBpB,CAqBO5C,aAAa,CAAC2C,GAAd,CAAkB,SAAAC,GAAG,qBAClB,YAAK,GAAG,CAAEA,GAAV,CAAyB,GAAG,CAAC,gBAA7B,CAA8C,SAAS,CAAC,WAAxD,CAAoE,KAAK,CAAC,IAA1E,CAA+E,MAAM,CAAC,IAAtF,EAAoBA,GAApB,CADkB,EAArB,CArBP,GA5DN,cAuFI,eACE,EAAE,CAAC,cADL,CAEE,IAAI,CAAC,QAFP,CAGE,SAAS,CAAC,oBAHZ,CAIE,QAAQ,CAAEnC,OAAO,CAAC,IAAD,CAAM,KAJzB,oBAvFJ,GADO,EADA,EADN,EAJF,GAFA,GADH,CAkHH,CArND,CAuNA,cAAe5B,CAAAA,aAAf","sourcesContent":["import React,{useState,useEffect} from 'react'\nimport Loader from \"../layouts/loader\";\nimport MetaData from '../layouts/MetaData';\nimport { useAlert } from 'react-alert';\nimport { useDispatch,useSelector } from 'react-redux';\nimport { updateProduct,clearErrors,getProductDetails } from '../../actions/productActions';\nimport { Link } from 'react-router-dom';\nimport Sidebar from './Sidebar';\nimport { UPDATE_PRODUCT_RESET } from '../../constants/productConstants';\nconst UpdateProduct = ({match,history}) => {\n    const [name,setName] = useState(\"\");\n    const [price,setPrice] = useState(0);\n    const [description,setDescription] = useState(\"\");\n    const [category,setCategory] = useState(\"\");\n    const [stock,setStock] = useState(0);\n    const [seller,setSeller] = useState(\"\");\n    const [images,setImages] = useState([]);\n    const [oldImages,setOldImages] = useState([]);\n    const [imagesPreview,setImagesPreview] = useState([]);\n    const alert = useAlert();\n    const dispatch = useDispatch();\n    const {error,product} = useSelector(state=>state.productDetails)\n  \n    const {loading,error:updateError,isUpdated} = useSelector(state=>state.deleteProduct);\n    const productId = match.params.id;\n    // const productId = match.params.id;\n \n   \n    const categories = [\n        \"Electronics\",\n        \"Cameras\",\n        \"Laptops\",\n        \"Accessories\",\n        \"Headphones\",\n        \"Food\",\n        \"Books\",\n        \"Clothes/Shoes\",\n        \"Beauty/Health\",\n        \"Sports\",\n        \"outdoor\",\n        \"Home\"\n    ]\n    useEffect(() => {\n        if(product && product._id!==productId){\n            // console.log(product._id,productId);\n            // console.log(\"im here\");\n\n            dispatch(getProductDetails(productId));\n        }else{\n            setName(product.name);\n            setPrice(product.price);\n            setDescription(product.description);\n            setCategory(product.category);\n            setSeller(product.seller);\n            setStock(product.stock);\n            setOldImages(product.images);\n        }\n        if(error){\n         alert.error(error);\n         dispatch(clearErrors());\n     }\n     if(updateError){\n        alert.error(updateError);\n        dispatch(clearErrors());\n     }\n     if(isUpdated){\n       history.push(\"/admin/products\");\n       alert.success(\"Product Updated Successfully\");\n       dispatch({type:UPDATE_PRODUCT_RESET})\n     }\n\n        // console.log(\"im in list orders\");\n     }, [error,alert,isUpdated,history,dispatch,product,productId])\n     const submitHandler = (e)=>{\n        // console.log(\"im in submit handler\");\n        // console.log(\"seller\",seller);\n        e.preventDefault();\n         const formData = new FormData();\n        formData.set(\"name\",name);\n        formData.set(\"price\",price);\n        formData.set(\"description\",description);\n        formData.set(\"category\",category);\n        formData.set(\"stock\",stock);\n        formData.set(\"seller\",seller);\n        images.forEach(image => {\n            formData.append('images', image)\n        })\n        // console.log(\"formData\",formData);\n        // console.log(\"id\",product._id)\n        dispatch(updateProduct(product._id,formData))\n       }\n       const onChange = e =>{\n        const files = Array.from(e.target.files);\n        setImagesPreview([]);\n        setImages([]);\n        setOldImages([]);\n        files.forEach(file=>{\n            const reader = new FileReader();\n            reader.onload = ()=>{\n                if(reader.readyState === 2){\n                    // console.log(\"reader\",reader.result);\n                    setImagesPreview(oldArray=>[...oldArray,reader.result]);\n                    setImages(oldArray=>[...oldArray,reader.result]);\n                }\n            }\n            reader.readAsDataURL(file);\n        })\n    }\n    return (\n       <>\n        <MetaData title={\"Update Product\"}></MetaData>\n       <div className=\"row\">\n         <div className=\"col-12 col-md-2\">\n             <Sidebar/>\n         </div>\n         <div className=\"col-12 col-md-10\">\n               <>\n               <div className=\"wrapper my-5\"> \n        <form onSubmit={submitHandler} className=\"shadow-lg\" encType='multipart/form-data'>\n            <h1 className=\"mb-4\">Update Product</h1>\n\n            <div className=\"form-group\">\n              <label htmlFor=\"name_field\">Name</label>\n              <input\n                type=\"text\"\n                id=\"name_field\"\n                className=\"form-control\"\n                value={name}\n                onChange={(e)=>setName(e.target.value)}\n              />\n            </div>\n\n            <div className=\"form-group\">\n                <label htmlFor=\"price_field\">Price</label>\n                <input\n                  type=\"text\"\n                  id=\"price_field\"\n                  className=\"form-control\"\n                  value={price}\n                  onChange={(e)=>setPrice(e.target.value)}\n                />\n              </div>\n\n              <div className=\"form-group\">\n                <label htmlFor=\"description_field\">Description</label>\n                <textarea className=\"form-control\" id=\"description_field\" rows=\"8\" value={description} onChange={(e)=>setDescription(e.target.value)}></textarea>\n              </div>\n\n              <div className=\"form-group\">\n                <label htmlFor=\"category_field\">Category</label>\n                <select className=\"form-control\" id=\"category_field\" value={category} onChange={(e)=>setCategory(e.target.value)}>\n                {categories.map(category=>(\n                    <option key={category} value={category}>{category}</option>\n                ))}\n                </select>\n              </div>\n              <div className=\"form-group\">\n                <label htmlFor=\"stock_field\">Stock</label>\n                <input\n                  type=\"number\"\n                  id=\"stock_field\"\n                  className=\"form-control\"\n                  value={stock}\n                  onChange={(e)=>setStock(e.target.value)}\n                />\n              </div>\n\n              <div className=\"form-group\">\n                <label htmlFor=\"seller_field\">Seller Name</label>\n                <input\n                  type=\"text\"\n                  id=\"seller_field\"\n                  className=\"form-control\"\n                  value={seller}\n                  onChange={(e)=>setSeller(e.target.value)}\n                />\n              </div>\n              \n              <div className='form-group'>\n                <label>Images</label>\n                \n                    <div className='custom-file'>\n                        <input\n                            type='file'\n                            name='product_images'\n                            className='custom-file-input'\n                            id='customFile'\n                            onChange={onChange}\n                            multiple\n                        />\n                        <label className='custom-file-label' htmlFor='customFile'>\n                            Choose Images\n                        </label>\n                    </div>\n                    \n                    {oldImages && oldImages.map(img=>(\n                        <img key={img} src={img.url} alt={img.url} className=\"mt-3 mr-2\" width=\"55\" height=\"52\"/>\n                    ))}\n\n                    {imagesPreview.map(img=>(\n                        <img src={img} key={img} alt=\"Images Preview\" className=\"mt-3 mr-2\" width=\"55\" height=\"52\"/>\n                    ))}\n            </div>\n\n  \n            <button\n              id=\"login_button\"\n              type=\"submit\"\n              className=\"btn btn-block py-3\"\n              disabled={loading?true:false}\n            >\n              UPDATE\n            </button>\n\n          </form>\n    </div>\n               \n               </>\n         </div>\n       </div>\n       </>\n    )\n}\n\nexport default UpdateProduct\n"]},"metadata":{},"sourceType":"module"}
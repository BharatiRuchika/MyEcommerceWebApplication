{"ast":null,"code":"import _slicedToArray from\"/Users/ruchikaashokbharati/Documents/Projects/Ecommerce/Ecommerce-Backend-main/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';// import { useDispatch, useSelector } from 'react-redux'\nimport{useDispatch,useSelector}from'react-redux';import{getProductDetails,clearErrors,newReview}from'../../actions/productActions';import ListReviews from'../review/ListReviews';import Loader from\"../layouts/loader\";import{useAlert}from'react-alert';// import '../../App.css';\nimport{Carousel}from'react-bootstrap';import MetaData from\"../layouts/MetaData\";import{CLEAR_ERRORS,NEW_REVIEW_RESET}from'../../constants/productConstants';import{addItemsCart}from\"../../actions/cartActions\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var ProductDetails=function ProductDetails(_ref){var match=_ref.match;var _useState=useState(1),_useState2=_slicedToArray(_useState,2),quantity=_useState2[0],setQuantity=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),comment=_useState4[0],setComment=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),rating=_useState6[0],setRating=_useState6[1];var dispatch=useDispatch();var alert=useAlert();console.log(match.params.id);var _useSelector=useSelector(function(state){return state.productDetails;}),loading=_useSelector.loading,error=_useSelector.error,product=_useSelector.product;var _useSelector2=useSelector(function(state){return state.auth;}),user=_useSelector2.user,token=_useSelector2.token;var _useSelector3=useSelector(function(state){return state.newReview;}),reviewError=_useSelector3.error,success=_useSelector3.success;// console.log(\"loading\",loading);\n// console.log(\"product\",product);\nuseEffect(function(){// console.log(\"im in useEffect\");\n// console.log(match.params.id);\ndispatch(getProductDetails(match.params.id));if(error){alert.error(error);dispatch(CLEAR_ERRORS);}if(reviewError){alert.error(error);dispatch(CLEAR_ERRORS);}if(success){alert.success('Reivew posted successfully');dispatch({type:NEW_REVIEW_RESET});}},[dispatch,alert,error,reviewError,success]);var increaseQty=function increaseQty(){var count=document.querySelector(\".count\");// console.log(\"stock\",product.stock)\nif(count.valueAsNumber>=product.stock)return;var qty=count.valueAsNumber+1;setQuantity(qty);};var decreaseQty=function decreaseQty(){var count=document.querySelector(\".count\");if(count.valueAsNumber<=1)return;var qty=count.valueAsNumber-1;setQuantity(qty);};var addToCart=function addToCart(){dispatch(addItemsCart(match.params.id,quantity));alert.success(\"item added to cart\");};function setUserRatings(){var stars=document.querySelectorAll('.star');//   console.log(\"stars\",stars);\nstars.forEach(function(star,index){star.starValue=index+1;['click','mouseover','mouseout'].forEach(function(e){star.addEventListener(e,showRatings);});});function showRatings(e){var _this=this;stars.forEach(function(star,index){if(e.type==='click'){if(index<_this.starValue){star.classList.add('orange');setRating(_this.starValue);}else{star.classList.remove('orange');}}if(e.type==='mouseover'){if(index<_this.starValue){star.classList.add('yellow');}else{star.classList.remove('yellow');}}if(e.type==='mouseout'){star.classList.remove('yellow');}});}}var reviewHandler=function reviewHandler(){// console.log(\"im in review handker\");\n// console.log(\"rating\",rating);\n// console.log(\"comment\",comment);\n// console.log(\"productId\",match.params.id);\nvar formData=new FormData();formData.set('rating',rating);formData.set('comment',comment);formData.set('productId',match.params.id);var body={rating:rating,comment:comment,productId:match.params.id};dispatch(newReview(formData,token));};return/*#__PURE__*/_jsx(_Fragment,{children:loading?/*#__PURE__*/_jsx(Loader,{}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"row f-flex justify-content-around\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-12 col-lg-5 img-fluid\",id:\"product_image\",children:/*#__PURE__*/_jsx(Carousel,{pause:\"hover\",children:product&&product.images&&product.images.map(function(image){return/*#__PURE__*/_jsx(Carousel.Item,{children:/*#__PURE__*/_jsx(\"img\",{className:\"d-block w-100\",src:image.url,alt:product.title})},image.public_id);})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-12 col-lg-5 mt-5\",children:[/*#__PURE__*/_jsx(\"h3\",{children:product.name}),/*#__PURE__*/_jsxs(\"p\",{id:product,children:[\"Product # \",product._id]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"rating-outer\",children:/*#__PURE__*/_jsx(\"div\",{className:\"rating-inner\",style:{width:\"\".concat(product.ratings/5*100,\"%\")}})}),/*#__PURE__*/_jsxs(\"span\",{id:\"no_of_reviews\",children:[\"(\",product.numOfReviews,\" Reviews)\"]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"p\",{id:\"product_price\",children:[\"$\",product.price]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stockCounter d-inline\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"btn btn-danger minus\",onClick:decreaseQty,children:\"-\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"form-control count d-inline\",value:quantity,readOnly:true}),/*#__PURE__*/_jsx(\"span\",{className:\"btn btn-primary plus\",onClick:increaseQty,children:\"+\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",id:\"cart_btn\",className:\"btn btn-primary d-inline ml-4\",disabled:product.stock===0,onClick:addToCart,children:\"Add to Cart\"}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Status: \",/*#__PURE__*/_jsx(\"span\",{id:\"stock_status\",className:product.stock>0?'greenColor':'redColor',children:product.stock>0?'In Stock':'Out of Stock'})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"h4\",{className:\"mt-2\",children:\"Description:\"}),/*#__PURE__*/_jsx(\"p\",{children:product.description}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"p\",{id:\"product_seller mb-3\",children:[\"Sold by: \",/*#__PURE__*/_jsx(\"strong\",{children:product.seller})]}),user?/*#__PURE__*/_jsx(\"button\",{id:\"review_btn\",type:\"button\",className:\"btn btn-primary mt-4\",\"data-toggle\":\"modal\",\"data-target\":\"#ratingModal\",onClick:setUserRatings,children:\"Submit Your Review\"}):/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger mt-5\",children:\" Login to submit your review\"}),/*#__PURE__*/_jsx(\"div\",{className:\"row mt-2 mb-5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"rating w-50\",children:/*#__PURE__*/_jsx(\"div\",{className:\"modal fade\",id:\"ratingModal\",tabIndex:\"-1\",role:\"dialog\",\"aria-labelledby\":\"ratingModalLabel\",\"aria-hidden\":\"true\",children:/*#__PURE__*/_jsx(\"div\",{className:\"modal-dialog\",role:\"document\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"modal-title\",id:\"ratingModalLabel\",children:\"Submit Review\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"close\",\"data-dismiss\":\"modal\",\"aria-label\":\"Close\",children:/*#__PURE__*/_jsx(\"span\",{\"aria-hidden\":\"true\",children:\"\\xD7\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[/*#__PURE__*/_jsxs(\"ul\",{className:\"stars\",children:[/*#__PURE__*/_jsx(\"li\",{className:\"star\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-star\"})}),/*#__PURE__*/_jsx(\"li\",{className:\"star\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-star\"})}),/*#__PURE__*/_jsx(\"li\",{className:\"star\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-star\"})}),/*#__PURE__*/_jsx(\"li\",{className:\"star\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-star\"})}),/*#__PURE__*/_jsx(\"li\",{className:\"star\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-star\"})})]}),/*#__PURE__*/_jsx(\"textarea\",{name:\"review\",id:\"review\",className:\"form-control mt-3\",value:comment,onChange:function onChange(e){return setComment(e.target.value);}}),/*#__PURE__*/_jsx(\"button\",{className:\"btn my-3 float-right review-btn px-4 text-white\",onClick:reviewHandler,\"data-dismiss\":\"modal\",\"aria-label\":\"Close\",children:\"Submit\"})]})]})})})})})]})]}),product.reviews&&product.reviews.length>0&&/*#__PURE__*/_jsx(ListReviews,{reviews:product.reviews})]})});};export default ProductDetails;","map":{"version":3,"sources":["/Users/ruchikaashokbharati/Documents/Projects/Ecommerce/Ecommerce-Backend-main/client/src/components/product/productdetails.js"],"names":["React","useEffect","useState","useDispatch","useSelector","getProductDetails","clearErrors","newReview","ListReviews","Loader","useAlert","Carousel","MetaData","CLEAR_ERRORS","NEW_REVIEW_RESET","addItemsCart","ProductDetails","match","quantity","setQuantity","comment","setComment","rating","setRating","dispatch","alert","console","log","params","id","state","productDetails","loading","error","product","auth","user","token","reviewError","success","type","increaseQty","count","document","querySelector","valueAsNumber","stock","qty","decreaseQty","addToCart","setUserRatings","stars","querySelectorAll","forEach","star","index","starValue","e","addEventListener","showRatings","classList","add","remove","reviewHandler","formData","FormData","set","body","productId","images","map","image","url","title","public_id","name","_id","width","ratings","numOfReviews","price","description","seller","target","value","reviews","length"],"mappings":"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","sourcesContent":["import React,{useEffect,useState} from 'react';\n// import { useDispatch, useSelector } from 'react-redux'\nimport { useDispatch,useSelector } from 'react-redux';\nimport { getProductDetails,clearErrors,newReview } from '../../actions/productActions';\nimport ListReviews from '../review/ListReviews'\nimport Loader from \"../layouts/loader\";\nimport { useAlert } from 'react-alert';\n// import '../../App.css';\nimport { Carousel } from 'react-bootstrap';\nimport MetaData from \"../layouts/MetaData\";\nimport { CLEAR_ERRORS,NEW_REVIEW_RESET } from '../../constants/productConstants';\nimport {addItemsCart} from \"../../actions/cartActions\";\nconst ProductDetails = ({match}) => {\n    const [quantity,setQuantity] = useState(1);\n    const [comment, setComment] = useState('');\n    const [rating, setRating] = useState(0);\n    const dispatch = useDispatch();\n    const alert = useAlert();\n    console.log(match.params.id);\n    const { loading, error, product } = useSelector(state => state.productDetails)\n    const {user,token} = useSelector(state=>state.auth);\n    const {error:reviewError,success} = useSelector(state=>state.newReview);\n    // console.log(\"loading\",loading);\n    // console.log(\"product\",product);\n    useEffect(() => {\n        // console.log(\"im in useEffect\");\n        // console.log(match.params.id);\n        dispatch(getProductDetails(match.params.id))\n        if(error){\n           alert.error(error)\n           dispatch(CLEAR_ERRORS)\n       }\n       if(reviewError){\n        alert.error(error)\n        dispatch(CLEAR_ERRORS)\n    } \n    if (success) {\n        alert.success('Reivew posted successfully')\n        dispatch({ type: NEW_REVIEW_RESET })\n    }\n\n    }, [dispatch,alert,error,reviewError,success])\n    const increaseQty = ()=>{\n        const count = document.querySelector(\".count\");\n        // console.log(\"stock\",product.stock)\n        if(count.valueAsNumber>=product.stock)\n        return\n        const qty = count.valueAsNumber + 1;\n        setQuantity(qty);\n    }\n\n    const decreaseQty = ()=>{\n        const count = document.querySelector(\".count\");\n        if(count.valueAsNumber<=1)\n        return\n        const qty = count.valueAsNumber - 1;\n        setQuantity(qty);\n    }\n    const addToCart = ()=>{\n        dispatch(addItemsCart(match.params.id,quantity))\n        alert.success(\"item added to cart\");\n    }\n   \n    function setUserRatings() {\n        const stars = document.querySelectorAll('.star');\n//   console.log(\"stars\",stars);\n        stars.forEach((star, index) => {\n            star.starValue = index + 1;\n\n            ['click', 'mouseover', 'mouseout'].forEach(function (e) {\n                star.addEventListener(e, showRatings);\n            })\n        })\n function showRatings(e) {\n        stars.forEach((star, index) => {\n            if (e.type === 'click') {\n                if (index < this.starValue) {\n                    star.classList.add('orange');\n\n                    setRating(this.starValue)\n                } else {\n                    star.classList.remove('orange')\n                }\n            }\n\n            if (e.type === 'mouseover') {\n                if (index < this.starValue) {\n                    star.classList.add('yellow');\n                } else {\n                    star.classList.remove('yellow')\n                }\n            }\n\n            if (e.type === 'mouseout') {\n                star.classList.remove('yellow')\n            }\n        })\n    \n    }\n}\n const reviewHandler = ()=>{\n        // console.log(\"im in review handker\");\n        // console.log(\"rating\",rating);\n        // console.log(\"comment\",comment);\n        // console.log(\"productId\",match.params.id);\n        const formData = new FormData();\n        formData.set('rating', rating);\n        formData.set('comment', comment);\n        formData.set('productId', match.params.id);\n        const body = {\n            rating,\n            comment,\n            productId:match.params.id\n        }\n        dispatch(newReview(formData,token));\n    }\n    return (<>\n  {loading?<Loader/>:(\n            <>\n            \n           \n            <div className=\"row f-flex justify-content-around\">\n            <div className=\"col-12 col-lg-5 img-fluid\" id=\"product_image\">\n               <Carousel pause='hover'>\n              {product && product.images && product.images.map(image=>(\n                   <Carousel.Item key={image.public_id}>\n                   <img className=\"d-block w-100\" src={image.url} alt={product.title} />\n               </Carousel.Item>\n               \n                 \n              ))}\n               </Carousel>\n            </div>\n\n            <div className=\"col-12 col-lg-5 mt-5\">\n                <h3>{product.name}</h3>\n                <p id={product}>Product # {product._id}</p>\n\n                <hr/>\n\n                <div className=\"rating-outer\">\n                    <div className=\"rating-inner\" style={{width:`${(product.ratings/5)*100}%`}}></div>\n                </div>\n                <span id=\"no_of_reviews\">({product.numOfReviews} Reviews)</span>\n\n                <hr/>\n\n                <p id=\"product_price\">${product.price}</p>\n                <div className=\"stockCounter d-inline\">\n                    <span className=\"btn btn-danger minus\" onClick={decreaseQty}>-</span>\n                    <input type=\"number\" className=\"form-control count d-inline\" value={quantity} readOnly />\n\n<span className=\"btn btn-primary plus\" onClick={increaseQty}>+</span>\n</div>\n<button type=\"button\" id=\"cart_btn\" className=\"btn btn-primary d-inline ml-4\" disabled={product.stock===0} onClick={addToCart}>Add to Cart</button>\n\n<hr/>\n\n<p>Status: <span id=\"stock_status\" className={product.stock>0?'greenColor':'redColor'}>{product.stock>0?'In Stock':'Out of Stock'}</span></p>\n\n<hr/>\n\n<h4 className=\"mt-2\">Description:</h4>\n<p>{product.description}</p>\n<hr/>\n<p id=\"product_seller mb-3\">Sold by: <strong>{product.seller}</strong></p>\n{user ? <button id=\"review_btn\" type=\"button\" className=\"btn btn-primary mt-4\" data-toggle=\"modal\" data-target=\"#ratingModal\" onClick={setUserRatings}>\n        Submit Your Review\n</button>:<div className=\"alert alert-danger mt-5\"> Login to submit your review</div>}\n\n\n<div className=\"row mt-2 mb-5\">\n                                <div className=\"rating w-50\">\n\n                                    <div className=\"modal fade\" id=\"ratingModal\" tabIndex=\"-1\" role=\"dialog\" aria-labelledby=\"ratingModalLabel\" aria-hidden=\"true\">\n                                        <div className=\"modal-dialog\" role=\"document\">\n                                            <div className=\"modal-content\">\n                                                <div className=\"modal-header\">\n                                                    <h5 className=\"modal-title\" id=\"ratingModalLabel\">Submit Review</h5>\n                                                    <button type=\"button\" className=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n                                                        <span aria-hidden=\"true\">&times;</span>\n                                                    </button>\n                                                </div>\n                                                <div className=\"modal-body\">\n\n                                                    <ul className=\"stars\" >\n                                                        <li className=\"star\"><i className=\"fa fa-star\"></i></li>\n                                                        <li className=\"star\"><i className=\"fa fa-star\"></i></li>\n                                                        <li className=\"star\"><i className=\"fa fa-star\"></i></li>\n                                                        <li className=\"star\"><i className=\"fa fa-star\"></i></li>\n                                                        <li className=\"star\"><i className=\"fa fa-star\"></i></li>\n                                                    </ul>\n                                                    <textarea\n                                                        name=\"review\"\n                                                        id=\"review\" className=\"form-control mt-3\"\n                                                        value={comment}\n                                                        onChange={(e) => setComment(e.target.value)}\n                                                    >\n\n                                                    </textarea>\n\n                                                    <button className=\"btn my-3 float-right review-btn px-4 text-white\" onClick={reviewHandler} data-dismiss=\"modal\" aria-label=\"Close\">Submit</button>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    {product.reviews && product.reviews.length > 0 && (\n                        <ListReviews reviews={product.reviews} />\n                    )} \n  </>\n            )}\n        </>\n    )\n}\n\nexport default ProductDetails\n"]},"metadata":{},"sourceType":"module"}